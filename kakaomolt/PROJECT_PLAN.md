# LawCall KakaoTalk 플러그인 기획안

## 프로젝트 개요

### 프로젝트명
**LawCall KakaoTalk AI 법률상담 플러그인**

### 목적
카카오톡 채널을 통해 일반 사용자들이 쉽게 AI 법률 상담을 받고, 전문 변호사 상담이 필요한 경우 LawCall 웹사이트로 연결하는 마케팅 퍼널 구축

### 대상 사용자
- 법률 문제에 직면한 일반인
- 변호사 상담이 필요하지만 어디서 시작해야 할지 모르는 사람들
- 간단한 법률 정보를 원하는 사용자

---

## 비즈니스 모델

### 수익 구조

```
┌─────────────────────────────────────────────────────────────┐
│                      수익 모델                               │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1. 크레딧 판매 (직접 수익)                                   │
│     - 사용자가 크레딧 충전 시 수익 발생                        │
│     - API 비용의 2배를 크레딧으로 청구                         │
│                                                             │
│  2. LawCall 상담 연결 (간접 수익)                             │
│     - 카카오톡 → LawCall 웹사이트 유입                        │
│     - 유료 법률 상담 전환                                     │
│                                                             │
│  3. 무료 사용자 (마케팅)                                      │
│     - 자체 API 키 등록 시 무료 이용                           │
│     - 브랜드 노출 및 입소문 효과                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 비용 구조

| 항목 | 월 예상 비용 | 비고 |
|------|-------------|------|
| Railway 호스팅 | $5-15 | 트래픽 기반 |
| Supabase | $0-25 | Free tier 또는 Pro |
| Claude API | 변동 | 사용량 기반 |
| **총합** | **$10-50/월** | 초기 운영 기준 |

### 손익분기점

- 크레딧 패키지 평균 판매가: 15,000원
- API 비용: 약 7,500원 (50%)
- 순이익: 약 7,500원/건
- 손익분기점: 월 5-7건 판매

---

## 핵심 기능

### 1. AI 법률 상담

```
사용자 → 카카오톡 메시지 → AI 분석 → 분야 판별 →
→ 일반 정보 제공 + LawCall 링크 제공
```

**지원 분야:**
- 민사 (계약, 손해배상, 부동산)
- 형사 (고소, 피해자 대리)
- 이혼/가사 (이혼, 양육권, 상속)
- 세무 (세무조사, 조세불복)
- 행정 (행정처분, 인허가)
- 헌법재판 (헌법소원)

### 2. 크레딧 시스템

**요금 정책:**
| 사용 방식 | 비용 |
|----------|------|
| 자체 API 키 등록 | 무료 |
| 플랫폼 API 사용 | API 비용의 2배 |

**크레딧 패키지:**
| 패키지 | 가격 | 크레딧 | 보너스 |
|--------|------|--------|--------|
| 기본 | 5,000원 | 5,000 | - |
| 표준 | 10,000원 | 10,000 | +2,000 |
| 프리미엄 | 20,000원 | 20,000 | +10,000 |
| 프로 | 50,000원 | 50,000 | +10,000 |

### 3. 분야별 라우팅

사용자 메시지에서 키워드를 분석하여 적절한 LawCall 상담 페이지로 연결:

```
"전세사기" → 민사 분야 → lawcall.com/civil
"이혼" → 가사 분야 → lawcall.com/family
"세무조사" → 세무 분야 → lawcall.com/tax
```

### 4. 결제 시스템 (Toss Payments)

- 신용카드, 체크카드, 간편결제 지원
- 환불 기능 지원
- 결제 내역 조회

---

## 기술 아키텍처

### 시스템 구성도

```
┌─────────────────────────────────────────────────────────────────┐
│                         사용자 레이어                             │
│  ┌─────────────┐                                                │
│  │ KakaoTalk   │ ← 사용자가 채널 추가 후 메시지 전송               │
│  └──────┬──────┘                                                │
│         │                                                       │
├─────────┼───────────────────────────────────────────────────────┤
│         ▼           Kakao 인프라                                 │
│  ┌─────────────┐                                                │
│  │ Kakao i     │ ← 스킬 서버로 메시지 전달                        │
│  │ Open Builder│                                                │
│  └──────┬──────┘                                                │
│         │ Webhook                                               │
├─────────┼───────────────────────────────────────────────────────┤
│         ▼           클라우드 인프라 (Railway)                     │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    LawCall Plugin                        │    │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────────┐ │    │
│  │  │Webhook  │→ │Billing  │→ │LawCall  │→ │   Claude    │ │    │
│  │  │Handler  │  │Handler  │  │Router   │  │     API     │ │    │
│  │  └─────────┘  └─────────┘  └─────────┘  └─────────────┘ │    │
│  └──────────────────────┬───────────────────────────────────┘    │
│                         │                                       │
├─────────────────────────┼───────────────────────────────────────┤
│         ▼               ▼          외부 서비스                    │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  Supabase   │  │    Toss     │  │  LawCall    │              │
│  │  Database   │  │  Payments   │  │   Website   │              │
│  └─────────────┘  └─────────────┘  └─────────────┘              │
└─────────────────────────────────────────────────────────────────┘
```

### 기술 스택

| 구분 | 기술 |
|------|------|
| 런타임 | Node.js 22+ |
| 언어 | TypeScript |
| 데이터베이스 | Supabase (PostgreSQL) |
| 결제 | Toss Payments |
| LLM | Claude API (Anthropic) |
| 호스팅 | Railway / Fly.io |
| 컨테이너 | Docker |

### 보안

| 항목 | 구현 |
|------|------|
| API 키 저장 | AES-256 암호화 |
| 사용자 ID | SHA-256 해싱 + Salt |
| 데이터베이스 | Row Level Security |
| 결제 | Toss Payments 인증 |

---

## 사용자 시나리오

### 시나리오 1: 신규 사용자 법률 상담

```
1. 카카오톡에서 "LawCall" 채널 검색
2. 채널 친구 추가
3. "전세사기 당했는데 어떻게 해야 하나요?" 메시지 전송
4. AI가 일반적인 대응 방법 안내
5. "민사 상담 바로가기" 버튼으로 LawCall 연결
6. LawCall에서 전문 상담 진행
```

### 시나리오 2: 크레딧 충전

```
1. "충전" 메시지 전송
2. 패키지 선택 (기본/표준/프리미엄/프로)
3. "결제하기" 버튼 클릭
4. Toss Payments 결제 진행
5. 크레딧 자동 충전
6. 상담 계속 이용
```

### 시나리오 3: 자체 API 키 등록

```
1. "API키 등록" 메시지 전송
2. 안내에 따라 "anthropic sk-ant-xxx..." 입력
3. API 키 검증
4. 등록 완료 → 이후 무료 이용
```

---

## 마일스톤

### Phase 1: MVP (2주)
- [x] 기본 웹훅 서버
- [x] Kakao i Open Builder 연동
- [x] Claude API 연동
- [x] 분야별 라우팅

### Phase 2: 결제 시스템 (1주)
- [x] Supabase 연동
- [x] 크레딧 시스템
- [x] Toss Payments 연동
- [x] API 키 암호화 저장

### Phase 3: 프로덕션 (1주)
- [x] Railway 배포
- [x] 환경변수 관리
- [ ] 모니터링 설정
- [ ] 알림 시스템

### Phase 4: 확장 (추후)
- [ ] 카카오 비즈니스 채널 승인
- [ ] Friend Talk (푸시 알림)
- [ ] 통계 대시보드
- [ ] 관리자 페이지

---

## 리스크 및 대응

| 리스크 | 영향 | 대응 방안 |
|--------|------|----------|
| Kakao API 변경 | 중 | 버전 관리, 문서화 |
| 결제 실패 | 상 | 재시도 로직, 고객 지원 |
| API 비용 급증 | 중 | 요금 알림, 일일 한도 |
| 서버 다운 | 상 | 헬스체크, 자동 재시작 |

---

## 연락처

- **프로젝트 담당**: 김재철 변호사
- **GitHub**: https://github.com/Kimjaechol/kakaomolt
- **LawCall**: https://lawcall.com

---

*이 기획안은 2024년 1월 기준으로 작성되었습니다.*
