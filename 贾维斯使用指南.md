# 贾维斯 Bot 使用指南

## 🎯 快速参考

### 当前配置
- **名称**: 贾维斯
- **响应前缀**: `[🤖贾维斯] `
- **授权手机**: +8613219870000
- **访问方式**: WhatsApp 自聊 / Web UI

---

## 🤖 多模型配置策略

### 文本对话
```
优先: GLM-4.7 (便宜快速)
      ↓ 失败时
备用: Kimi K2.5 (更强大)
```

### 图片识别
```
优先: Kimi K2.5 (识别能力强)
      ↓ 失败时
备用: GLM-4V-Plus (基础识别)
```

### 视频解析
```
直接使用: Kimi K2.5 (唯一支持视频)
```

---

## 📱 WhatsApp 使用

### 发送文本消息
```
你: 你好，贾维斯
Bot: [🤖贾维斯] 你好！有什么可以帮你的？
```

### 发送图片
```
1. 拍照或选择图片
2. 添加文字：这是什么？
3. 发送
Bot: [🤖贾维斯] 这是一张...（图片描述）
```

### 发送视频
```
1. 拍摄或选择视频
2. 添加文字：视频里发生了什么？
3. 发送
Bot: [🤖贾维斯] 视频中...（视频描述）
```

---

## 🌐 Web UI 使用

### 访问地址
```
http://127.0.0.1:18789/?token=bcc23aec448df5480c0389af4daec5286f3e30cfab713f11e180d7348aaee987
```

**或者双击**: `打开WebUI.bat`

### 功能菜单
- 💬 **聊天**: 直接对话
- 📊 **Overview**: 系统状态
- 📡 **Channels**: WhatsApp 管理
- ⚙️ **设置**: 配置修改
- 🛠️ **技能**: Skills 管理
- 📝 **日志**: 查看审计日志

---

## 🧪 测试清单

### 测试1: 文本对话（GLM-4.7）
- [ ] 发送: `你好`
- [ ] 预期: `[🤖贾维斯] 你好！...`

### 测试2: 图片识别（Kimi K2.5）
- [ ] 发送图片 + `这是什么？`
- [ ] 预期: 详细图片描述

### 测试3: 视频解析（Kimi K2.5）
- [ ] 发送视频 + `发生了什么？`
- [ ] 预期: 视频内容描述

### 测试4: Fallback 机制
- [ ] 如果 GLM 失败，应自动切换到 Kimi

---

## 💰 成本估算

### 日常使用（假设每天100条消息）
- **文本对话**: 100条 × 平均200tokens × ¥0.015/千 = **¥0.3/天**
- **图片识别**: 5张 × 平均1000tokens × ¥0.12/千 = **¥0.6/天**
- **视频解析**: 2个 × 平均2000tokens × ¥0.12/千 = **¥0.48/天**
- **总计**: 约 **¥1.4/天** 或 **¥42/月**

如果只用 GLM-4.7（不发图片/视频）：
- **总计**: 约 **¥0.3/天** 或 **¥9/月**

---

## 🔧 常用命令

### 重启网关
```bash
cd "D:\项目库\MOLTBOT助理"
./start-jarvis-whatsapp.sh
```

### 查看日志
```bash
tail -f ~/.clawdbot/security-audit.log
```

### 检查配置
```bash
cat ~/.moltbot/moltbot.json
```

### 验证环境变量
```bash
source ~/.clawdbot/env.sh
echo $ZAI_API_KEY | head -c 10
echo $MOONSHOT_API_KEY | head -c 10
```

---

## 🆘 故障排除

### 问题: 收到 "connection error"
- **检查**: API 密钥是否正确
- **解决**: 编辑 `~/.clawdbot/env.sh` 重新配置

### 问题: Web UI 无法访问
- **检查**: 网关是否运行
- **解决**: 重启网关或使用带 token 的 URL

### 问题: 图片无法识别
- **检查**: Moonshot API 密钥是否有效
- **解决**: 检查 `echo $MOONSHOT_API_KEY`

### 问题: 响应前缀不显示
- **检查**: 是否重启了网关
- **解决**: 配置修改后必须重启

---

## 📚 配置文件位置

| 文件 | 路径 | 用途 |
|------|------|------|
| 主配置 | `~/.moltbot/moltbot.json` | 模型、通道配置 |
| 环境变量 | `~/.clawdbot/env.sh` | API 密钥 |
| 审计日志 | `~/.clawdbot/security-audit.log` | 安全日志 |
| 工作区 | `C:\Users\55239\clawd\` | Agent 文件 |

---

## ⚙️ 高级功能

### 添加更多 Skills
1. Web UI → 技能
2. 浏览器可用 Skills
3. 启用/禁用开关

### 配置 MCP Servers
1. Web UI → 配置
2. 添加 MCP Server
3. 示例: filesystem, brave-search

### 查看使用统计
```bash
# 查看今天的 API 调用
grep "$(date +%Y-%m-%d)" ~/.clawdbot/security-audit.log | grep "api\."
```

---

**文档生成时间**: 2026-01-29
**系统版本**: Moltbot 2026.1.27-beta.1
**安全等级**: 企业级（5层防护）
