# Web UI 语音输入实现计划

根据您的要求，我将直接在 OpenClaw 的 Web 聊天界面（Control UI）中添加一个 **语音输入按钮**。通过浏览器原生的 Web Speech API 实现“点击即听”，无需复杂的后端配置。

## 计划步骤

### 1. 添加麦克风图标

**文件**: `ui/src/ui/icons.ts`

- 添加 `mic` (麦克风) 和 `micOff` (停止录音) 的 SVG 图标。

### 2. 添加录音状态与逻辑

**文件**: `ui/src/ui/app.ts`

- 在 `OpenClawApp` 类中添加状态 `@state() chatRecording = false`。
- 添加 `toggleRecording()` 方法：
  - 检查浏览器是否支持 `SpeechRecognition` (Chrome/Safari/Edge 原生支持)。
  - **开始录音**: 启动识别，监听 `onresult` 事件，将识别到的文字自动追加到当前的输入框 (`chatMessage`) 中。
  - **停止录音**: 点击停止或识别结束后自动重置状态。

### 3. 传递录音控制权

**文件**: `ui/src/ui/app-render.ts`

- 将 `isRecording` 状态和 `onToggleRecording` 方法传递给 `renderChat` 组件。

### 4. 在聊天界面添加按钮

**文件**: `ui/src/ui/views/chat.ts`

- 在输入框的“发送”按钮左侧添加一个新的 **麦克风按钮**。
- 按钮样式：
  - 未录音时：显示灰色麦克风。
  - 录音中：显示红色/高亮麦克风（或带有脉冲动画），提示正在监听。

## 预期效果

1.  打开 OpenClaw Web 界面。
2.  在聊天输入框旁边看到一个新的麦克风图标。
3.  点击图标，浏览器提示请求麦克风权限（首次）。
4.  您说话，文字会自动出现在输入框中。
5.  再次点击或停止说话后，录音结束，您可以修改或直接发送。

这个方案完全符合“不复杂”、“点击一下”、“监听输入”的需求。

**是否确认执行？**
